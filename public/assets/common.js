if(!EOL)var EOL={};(function(){var e=$.event.props,t=e.length,n=[];while(t--){var r=e[t];r!="layerX"&&r!="layerY"&&n.push(r)}$.event.props=n})(),$.ajaxSetup({accepts:{"*":"text/javascript, */*",html:"text/javascript",json:"application/json, text/javascript",script:"text/javascript",text:"text/plain",xml:"application/xml, text/xml"}}),$("html :not(.thumbnails ul li)").bind("ajaxStart",function(){$(this).addClass("busy")}).bind("ajaxStop",function(){$(this).removeClass("busy")}),$(document).on("mouseover","#social_sharing .facebook",function(){$(".jcrop-holder").length>0&&$("#social_sharing .facebook").css("z-index",parseInt($(".jcrop-holder > div:first").css("z-index"))+1)}),EOL.prep_flashes=function(){if($("#flashes")[0]==undefined){var e=$("#page_heading .hgroup");$("#page_heading div.page_actions").length>0&&(e=$("#page_heading div.page_actions")),e.after('<div id="flashes" style="clear: both; width: 100%;"></div>')}},EOL.check_siblings=function(e,t){try{$($(e).siblings()).prop("checked",t)}catch(n){}},$(function(){function e(e,r,s){if(!s.addSlide)return;cycle_list_item=$(this).closest("li"),number_of_images_in_li=cycle_list_item.find("img").size(),number_of_images_in_li<10&&($.getJSON("content/random_homepage_images?count=5",function(e){if(!e.error)for(i=0;i<e.length;i++)image_data=e[i],$("img[src='"+image_data["image_url"]+"']").size()==0&&(scientific_name=image_data.taxon_scientific_name,common_name=image_data.taxon_common_name,common_name==null&&(common_name=""),alt_text=scientific_name,s.addSlide('<a href="'+image_data.taxon_page_path+'"><img src="'+image_data.image_url+'" alt="'+alt_text+'" data-scientific_name="'+scientific_name+'" data-common_name="'+common_name+'" width="130" height="130"/></a>'),s.nextSlide=s.currSlide+1,t())}),cycle_list_item.hasClass("hover")&&n($(r).find("img")))}function t(){$(".thumbnails li img").unbind().mouseover(function(){n($(this))})}function n(e){var t=e.parent().parent();if(t.length>0){$thumbs=t.closest(".thumbnails");var n=$thumbs.find(".term p"),r=t.position().left-100+5,i=n.outerWidth(!0)-t.position().left-t.outerWidth(!0)-100;t.is($(".thumbnails li:last"))&&(i-=15);var s="inherit";if(e.attr("data-common_name")==null||e.attr("data-common_name")=="")s=$thumbs.find(".term .site_column").css("height");var o='<span class="scientific">'+e.attr("data-scientific_name")+"</span>";e.attr("data-common_name")!=null&&e.attr("data-common_name")!=""&&(o+='<span class="common">'+e.attr("data-common_name")+"</span>"),n.css({textAlign:"center"}).css("margin-left",r+"px").css("margin-right",i+"px").css("line-height",s).html(o),$(".thumbnails li").removeClass("hover"),t.addClass("hover")}}$(".heading form.filter, form.select_submit").find(".actions").hide().find(":submit").end().end().find("select").change(function(){$(this).closest("form").submit()}),function(e){var t='<li class="placeholder"></li>';e.each(function(){var e=$(this),n=[];$("<ul />",{"class":"thumbnails"}).insertBefore(e.find("p.all")),e.find(".image > a > img").each(function(){var e=$(this),r;e.is("[data-thumb]")?r='<li><a href="#"><img src="'+e.attr("data-thumb")+'" alt="'+e.attr("alt")+'" /></a></li>':r=t,n.push(r)});for(var r=1,i=4-n.length;r<=i;r++)n.push(t);e.find(".thumbnails").html(n.join("")),e.find(".thumbnails li").not(".placeholder").eq(0).addClass("active")}),e.find(".image > a img").each(function(){this.onload=function(){$(this).data("height",this.height)}}),e.find(".thumbnails").delegate("a","click",function(){var e=$(this).closest("li");return e.closest("ul").find(".active").removeClass("active"),e.addClass("active"),!1}),"cycle"in $.fn&&e.find(".images").cycle({speed:500,timeout:0,pagerAnchorBuilder:function(t){return e.selector+" .thumbnails a:eq("+t+")"}})}($(".gallery")),function(e){e.find("li .overlay").click(function(){return window.location=$(this).parent().find("a").attr("href"),!1})}($("#media_list")),function(e){e.find("p a").accessibleClick(function(){var t=$(this),n=t.closest(e.selector).find("ul");return n.is(":visible")?(n.hide(),!1):(n.show(),$(document).click(function(t){$(t.target).closest(e.selector).length||(e.find("ul").hide(),$(this).unbind(t))}),!1)})}($(".language")),function(e){e.children().each(function(){var e=$(this);e.delegate("ul.actions a.edit_comment","click keydown",function(e){e.preventDefault(),$(this).closest("ul.actions").hide(),$(this).closest(".details").after('<div class="comment_edit_form"></div>');var t=$(this).closest(".details").next(".comment_edit_form");EOL.ajax_get($(this),{update:t,type:"GET"})}),e.delegate(".comment_edit_form a","click keydown",function(e){e.preventDefault(),$(this).closest(".comment_edit_form").hide().prev(".details").find("ul.actions").show().end().end().remove()}),e.delegate(".comment_edit_form input[type='submit']","click keydown",function(e){e.preventDefault(),EOL.ajax_submit($(this))}),e.delegate("form.delete_comment input[type='submit']","click keydown",function(e){e.preventDefault(),confirm($(this).data("confirmation"))&&EOL.ajax_submit($(this))})})}($("ul.feed")),function(e){e.focusout(function(){if($("#data_object_object_title").val()==""){var t="url="+e.val()+"&lang="+$("html").attr("lang");$.ajax({url:"/fetch_external_page_title",data:t,dataType:"json",beforeSend:function(e){$(".link_object span.errors").text($(".link_object span.errors").attr("data-pending_message"))},success:function(e){e.exception==1?$(".link_object span.errors").text(e.message):($(".link_object span.errors").text(""),$("#data_object_object_title").val()==""&&$("#data_object_object_title").val(e.message))}})}})}($(".link_object #data_object_source_url")),function(e){var t=1e3;e.find("ul.collection_gallery").children().each(function(){var e=$(this);$.browser.msie&&(e.css("z-index",t),t-=1),e.find(".checkbox input[type=checkbox]").is(":checked")||e.find(".checkbox").hide(),e.find("h4").hide(),e.accessibleHover(function(){$(this).find(".checkbox").show(),$(this).find("h4").addClass("balloon").show()},function(){$(this).find(".checkbox input[type=checkbox]").is(":checked")||$(this).find(".checkbox").hide(),$(this).find("h4").hide().removeClass("balloon")})}),e.find("#sort_by").change(function(){$(this).closest("form").find('input[name="commit_sort"]').click()}),e.find('input[name="commit_sort"]').hide(),e.find("#view_as").change(function(){$(this).closest("form").find('input[name="commit_view_as"]').click()}),e.find('input[name="commit_view_as"]').hide(),e.find('input[name="commit_filter"]').hide()}($("#collection")),$("#simple_search input[placeholder]").each(function(){var e=$(this),t=e.attr("placeholder");e.removeAttr("placeholder").val(t),e.bind("focus blur",function(n){n.type==="focus"&&e.val()===t?e.val(""):e.val()||e.val(t)})}),$("#collection_items .editable .edit a").modal({beforeSend:function(){$("#collection_items .editable a").fadeTo(225,.3)},beforeShow:function(){$("form.edit_collection_item :submit").click(function(){return EOL.ajax_submit($(this),{update:$("li#collection_item_"+$(this).attr("data-id")+" div.editable")}),$("#collection_items_edit a.close").click(),!1})},afterClose:function(){$("#collection_items .editable a").delay(25).fadeTo(100,1,function(){$("#collection_items .editable a").css({filter:""})})},duration:200}),$("a.collect").modal({beforeSend:function(){$("a.collect").fadeTo(225,.3)},beforeShow:function(){$("form#new_collection :submit").click(function(){return $("#collection_name").val()==""?($(".collection_name_error").show(),!1):(EOL.prep_flashes(),EOL.ajax_submit($(this),{update:$("#flashes")}),$("#choose_collections a.close").click(),!1)}),$("form#new_collection_item :submit").click(function(){return EOL.prep_flashes(),EOL.ajax_submit($(this),{update:$("#flashes")}),$("#choose_collections a.close").click(),!1}),$("#choose_collections a.close_and_go").click(function(){$("#choose_collections a.close").click()})},afterClose:function(){$("a.collect").delay(25).fadeTo(100,1,function(){$("a.collect").css({filter:""})})},duration:200}),$("a.reindex").click(function(){var e=$("a.reindex");return e.fadeTo(225,.3),EOL.prep_flashes(),EOL.ajax_submit($(this),{url:e.attr("href"),data:{},update:$("#flashes")}),!1}),EOL.enableRatings(),$(".thumbnails ul li").each(function(){var t=$(".thumbnails ul li").length,r=$(this).index(),i=new Array(-3,1,0,-2,-4,-1),s=5e3,o=1800;$(this).cycle({fx:"fade",timeout:t*s,delay:i[r]*s,speed:o,before:e});var u=Math.floor(Math.random()*6)+1;n($(".thumbnails li:nth-child("+u+") img:first"))}),t(),$("#main_search_type_filter input[type=checkbox][value!='all']").click(function(){$("#main_search_type_filter input[type=checkbox][value='all']").prop("checked",!1)}),$("#main_search_type_filter input[type=checkbox][value='all']").click(function(){$("#main_search_type_filter input[type=checkbox][value!='all']").prop("checked",!1)}),$("#main_search_type_filter li.no_results input[type=checkbox]").attr("disabled",!0),$("#simple_search :submit").click(function(){var e=$("#simple_search :submit").closest("form").find("#q");if(e.val()==$(this).attr("data_unchanged"))return e.css("color","#aa0000").val($(this).attr("data_error")).click(function(){$(this).val("").css("color","black").unbind("click")}),!1;if(e.val()==$(this).attr("data_error")){var t=20,n=240;return e.css("color","#aa0000").fadeOut(n).fadeIn(t).fadeOut(n).fadeIn(t).fadeOut(n).fadeIn(t),!1}}),$("#media_list #sidebar input[type=checkbox][value!='all']").click(function(){$("#media_list #sidebar input[type=checkbox][value='all'][name='"+$(this).attr("name")+"']").prop("checked",!1)}),$("#media_list #sidebar input[type=checkbox][value='all']").click(function(){$("#media_list #sidebar input[type=checkbox][value!='all'][name='"+$(this).attr("name")+"']").prop("checked",!1)}),$("#media_list #sidebar li.no_results input[type=checkbox]").attr("disabled",!0),$(".button.confirm").click(function(){return confirm($(this).attr("data_confirm"))?!0:!1}),$("form.new_collection_job #scope").change(function(){$("form.new_collection_job #scope").val()=="all_items"?$("#collection_items :checkbox").parent().hide():$("#collection_items :checkbox").parent().show()}),$("#main .media video embed").each(function(){var e=document.createElement("video");cant_play_video=!e.canPlayType||!e.canPlayType("video/mp4");if(cant_play_video){var t=$(this).parent();t.parent().html(t.html())}}),function(e){e.attr("href",function(){auth_provider=$(".inat_observations_header a.button").attr("href").split("&")[1];if(typeof auth_provider!="undefined")return this.href+"?"+auth_provider})}($(".inat_top_contributors a")),function(e){var t=e.find("dl.resources :radio");t.change(function(){t.each(function(){var e=$(this),t=e.closest("dt").next("dd");e.is(":checked")?t.slideDown(200):t.slideUp(200)})}).not(":checked").closest("dt").next("dd").hide()}($("#content_partner_resources")),$('td.preferred_entry_selector input[type="radio"]:not(:checked)').click(function(){var e=$(this).closest("form");e.submit()}),function(e){var t=e.find("form"),n=$.extend(t.data("datepicker_opts"),{isRTL:$("body").css("direction")=="rtl"?!0:!1,showOn:"button",buttonImage:"/assets/v2/icon_calendar.png",buttonImageOnly:!0,minDate:new Date(2012,1,17),maxDate:new Date});t.addClass("with_picker"),t.find("label").each(function(){var e=$(this);e.append('<input type="hidden"/>'),e.find('input[type="hidden"]').datepicker($.extend(n,{defaultDate:new Date(e.find("select:eq(2)").val(),e.find("select:eq(1)").val()-1,e.find("select:eq(0)").val()),onSelect:function(t,n){e.find("option:selected").removeAttr("selected"),e.find('select:eq(0) option[value="'+n.selectedDay+'"]').attr("selected","selected"),e.find('select:eq(1) option[value="'+(n.selectedMonth+1)+'"]').attr("selected","selected"),e.find('select:eq(2) option[value="'+n.selectedYear+'"]').attr("selected","selected"),e.closest("form").submit()}}))})}($("#statistics")),$("input.clear_on_focus").each(function(){$(this).val($(this).attr("data-default"))}),$("input.clear_on_focus").siblings().each(function(){$(this).on("click",function(){$(this).prop("checked")&&$(this).siblings().focus()})}),$("input.clear_on_focus").on("focus",function(){$(this).val()==$(this).attr("data-default")&&($(this).val(""),EOL.check_siblings(this,!0))}),$("input.clear_on_focus").on("blur",function(){if($(this).val()==""||$(this).val()==$(this).attr("data-default"))$(this).val($(this).attr("data-default")),EOL.check_siblings(this,!1)}),$("input#collection_job_overwrite").on("click",function(){$(this).prop("checked")?$("form#new_collection_job li.collected input").prop("checked",!1).attr("disabled",!1):$("form#new_collection_job li.collected input").prop("checked",!0).attr("disabled",!0)})}),function(e){e.fn.accessibleClick=function(t,n){if("join"in t)t.push(13);else{if(typeof t!="function")return this;n=t}return this.each(function(){e(this).click(function(e){return!e.keyCode&&e.layerY>0||e.layerY===undefined?n.apply(this):!1}).keyup(function(r){if(r.keyCode===13||e.inArray(r.keyCode,t)!==-1)return n.apply(this)})})},e.fn.accessibleHover=function(e,t){return this.bind("mouseenter mouseover focusin focus",e).bind("mouseleave mouseout focusout blur",t)},e.fn.hasAttr=function(e){return this.is("["+e+"]")}}(jQuery),EOL.ajax_submit=function(e,t){t=typeof t!="undefined"?t:{};var n=e==null?null:e.closest("form"),r="";typeof t.update!="undefined"?r=t.update:r=e.closest(".editable");var i="";typeof t.url!="undefined"?i=t.url:typeof e.attr("data_url")!="undefined"?i=e.attr("data_url"):i=n.attr("action");var s="";return typeof t.data!="undefined"?s=t.data:s=n.serialize(),complete="",typeof t.complete!="undefined"&&(complete=t.complete),type="POST",typeof t.type!="undefined"&&(type=t.type),$.ajax({url:i,data:s,type:type,dataType:"html",beforeSend:function(e){r.fadeTo(225,.3)},success:function(e){r.html(jQuery.trim(e))},error:function(e,t,n){r.html("<p>Sorry, there was an error: "+t+"</p>")},complete:function(){r.delay(25).fadeTo(100,1,function(){r.css({filter:""})}),complete!=""&&complete()}}),!1},EOL.ajax_get=function(e,t){var n="";return typeof t.update!="undefined"?n=t.update:n=e.closest(".editable"),complete="",typeof t.complete!="undefined"&&(complete=t.complete),$.ajax({url:e.attr("href"),dataType:"html",beforeSend:function(e){n.fadeTo(300,.3)},success:function(e){n.html(e)},error:function(e,t,r){n.html("<p>Sorry, there was an error: "+t+"</p>")},complete:function(){n.delay(25).fadeTo(100,1,function(){n.css({filter:""})}),complete!=""&&complete()}}),!1},EOL.enableRatings=function(){$(".media .ratings .rating ul > li > a").unbind("click").click(function(){var e=$(this).closest("div.ratings");return EOL.ajax_submit($(this),{url:$(this).attr("href"),update:e,type:"GET"}),!1})},EOL.loadTwitter=function(){$(".twitter-share-button").length>0&&(typeof twttr!="undefined"?(twttr.widgets.load(),EOL.initTwitter()):$.getScript("http://platform.twitter.com/widgets.js",function(){EOL.initTwitter()}))},EOL.initTwitter=function(){typeof _ga!="undefined"&&_ga.trackTwitter()},EOL.loadFacebook=function(e,t){$("#fb-root").length>0&&(typeof FB!="undefined"?EOL.initFacebook():$.getScript("http://connect.facebook.net/en_US/all.js",function(){EOL.initFacebook(e,t)}))},EOL.initFacebook=function(e,t){FB.init({appId:e,channelUrl:t,logging:!0,status:!0,cookie:!0,xfbml:!0}),typeof _ga!="undefined"&&_ga.trackFacebook()},EOL.after_onload_JS=function(e){(function(t,n,r){function i(){head.js(e)}t.addEventListener?t.addEventListener("load",i,!1):t.attachEvent&&t.attachEvent("onload",i)})(window,document,"script")};