-# TODO - Add a selector to Narrow the list by Content Provider
= render :partial => '/data_objects/curation_js'
= render :partial => 'filter_form'
- if @name.blank? 
  - name = ""
  - msg = ""
- else
  - name = " for #{@name}"
  - msg = "You are curating images #{name}. "
- if @images_to_curate.blank?
  - status = @status.blank? ? "" : ((@status == 'all') ? "" : (@status == 'Unknown') ? "Unreviewed " : "#{@status} ")
  - ctnt_ptnr = @ctnt_ptnr.blank? ? "" : "#{@ctnt_ptnr} "
  %hr.thin
  = "There is no #{status}#{ctnt_ptnr}content#{name}, please select another group to curate or change your source or vetting status criteria."
- else
  %hr.thin
  = "#{msg}Images are sorted by EOL import date, with newest items shown first. There are #{@all_images_count} images in this work list."
  = will_paginate(@images_to_curate, :params => params)
  %table.results_table
    %tr
      %th
        Image
      %th{ :width => 368 }
        Actions
    - @images_to_curate.each do |data_object|
      / %tr{ :id => "undo-move-#{data_object.id}", :class => 'hide ' + data_object.vetted.label.downcase }
      /   %td{ :colspan => 2 }
      /     You moved the image to 
      /     = link_to("your ignored list", {:controller => :curators, :action => :ignored_images, :hierarchy_entry_id => params[:hierarchy_entry_id]}) + "."
      /     = "&nbsp;" * 5
      /     %a{ :class => "undo-ignore-image" } Undo
      %tr{ :id => "curation-item-#{data_object.id}" }
        %td{ :class => "overlay_link " + data_object.vetted.label.downcase }
          .curation-item
            %h5
              = taxon_concept_link(nil, :data_type => "image", :data_object_id => data_object.id, :name_string => data_object.first_concept_name, :taxon_concept_id => data_object.first_hierarchy_entry.taxon_concept_id, :popup => true)
            - if common_name = data_object.first_concept_common_name
              %h6
                = common_name.firstcap
            = link_to(image_tag(DataObject.image_cache_path(data_object.object_cache_url, :medium), :class => 'curation-thumb'), {:action => 'curate_image', :data_object_id => data_object.id}, {:rel => '#overlay'})
            - unless data_object.created_at.blank?
              %em
                = "Indexed on:"[]
              = DateTime.parse(data_object.created_at.to_s).strftime("%B %d, %Y")
              %br
            - unless data_object.description.blank?
              %h6
                = "Description:"[]
              = strip_tags(data_object.description).cleanup_for_presentation
            - unless data_object.location.blank?
              %h6 
                = "Location:"[]
              = truncate(data_object.location, 48)
        %td{ :class => data_object.vetted.label.downcase }
          = render :partial => 'curation_tools', :locals => {:data_object => data_object, :comment_height => 3, :comment_width => 24}
  = will_paginate(@images_to_curate, :params => params)
  #overlay.overlay_worklist{:style => 'display:none'}
    .content-wrap
= javascript_include_tag 'rating.js' # basically, I'm only using this to update after calling the ajax, below...
= javascript_include_tag 'curation_tools.js'
= javascript_include_tag 'text-content.js'
