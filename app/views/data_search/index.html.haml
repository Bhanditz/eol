- if @results.blank?
  - if @results
    - if @attribute
      .empty
        %p= data_search_results_summary
  - else
    .empty
      %p= I18n.t(:data_server_unavailable)
- else
  - if @attribute_known_uri
    .definition
      %ul.glossary
        = render('known_uris/definition', { known_uri: @attribute_known_uri, attribution: true, glossary_link: true })
  .header
    - start_number = (@results.current_page - 1) * @results.per_page + 1
    - end_number = [ (start_number + @results.per_page - 1), @results.total_entries ].min
    - previous_label = (@results.current_page == 1) ? '' : I18n.t(:pagination_previous_with_count, count: @results.per_page)
    - next_label = (@results.current_page == @results.total_pages) ? '' : I18n.t(:pagination_next_with_count, count: @results.per_page)
    %h3= raw(I18n.t(:displaying_numerical_range_eol_records_with_count, start_number: start_number, end_number: end_number, count: @results.total_entries))
    = will_paginate @results, previous_label: previous_label, next_label: next_label, page_links: false
  #taxon_data
    = javascript_include_tag 'https://www.google.com/jsapi'
    :javascript
      google.load("visualization", "1", { packages:["corechart"] });
      google.setOnLoadCallback(drawChart);
      function drawChart() {
        var dataTable = new google.visualization.DataTable()
        dataTable.addColumn('string', null);
        dataTable.addColumn('number', 'Value');
        dataTable.addColumn({ type: 'string', role: 'tooltip', p: { html: true } });
        dataTable.addColumn({ type: 'string', role: 'style' });
        var data = [
          #{
            @graph_results.collect do |d|
              "[ '', #{ d[:value] }, \"#{ data_graph_result_html(d).gsub(/"/, '\"') }\", 'opacity: 0.8' ]\n"
            end.join(', ')
          }
        ];
        dataTable.addRows(data);
        var options = {
          tooltip: { isHtml: true, trigger: 'selection, focus' },
          bar: { groupWidth: '100%' },
          titlePosition: 'none',
          hAxis: { textPosition: 'none', title: null },
          vAxis: { title: null },
          chartArea: { width: '90%', height: '80%' },
          legend: 'none'
        };
        var chart = new google.visualization.ColumnChart(document.getElementById('chart_div'));
        chart.draw(dataTable, options);
      }
    #chart_div{ style: "width: 900px, height: 500px;" }
    %table.standard.data.search
      - @results.each_with_index do |data_point_uri, index|
        = render 'data_point_uris/display_rows', { data_point_uri: data_point_uri, for_search: true,
          header_id: "result_#{index}" }
